import{d as ia,r as c,E as ra,R as sa,G as na,J as je,f as H,p as J,o as ua,a as m,c as k,b as x,h as xe,g as a,i as re,n as Ie,j as E,B as da,F as He,x as ze,t as se,e as I,q as fa,s as ca,_ as va}from"./entry.471e63e0.js";import{u as ma}from"./composables.306da403.js";import{u as pa}from"./index.6e57601f.js";import{u as ya,f as yl,a as We,g as ga,i as ha,j as ba,k as _a,l as Fa,B as ka,m as Sa,n as Va,C as Da,o as xa,p as Ia,q as Ca,r as wa,t as Pa,v as La,w as Oa,x as Aa,y as Ea,z as qa,A as Na,e as Ta,h as $a,b as Ba,c as gl,d as Ma,D as Ra,E as Ua}from"./TextElement.vue_vue_type_style_index_0_lang.8c59339b.js";import{A as hl,y as bl,z as ja,u as Ha,w as _l,r as Qe,x as Ce,l as Je,f as we}from"./helpers.b5f0f0c3.js";/* empty css            */import{i as za,f as Wa}from"./funnel_event_helper.bd666bbb.js";import{_ as Ye}from"./MoonLoader.vue_vue_type_style_index_0_lang.1e097d37.js";import{c as Qa}from"./Countries.69e07731.js";import{i as Ja,g as Ya,a as Ka,b as Ga,d as Xa,s as Za,e as eo}from"./Attributions.12085d1c.js";import{u as lo}from"./index.61776e8a.js";import{_ as ao}from"./HtmlPreview.vue_vue_type_script_setup_true_lang.3f57357c.js";import"./utils.72c8fdcc.js";import"./Recaptcha.vue_vue_type_script_setup_true_lang.75051b0d.js";import"./optimize_script.0a734f60.js";import"./IntlTel.79cafbb6.js";import"./index.b9ac6e2d.js";const Fl=z=>(fa("data-v-c76b41cf"),z=z(),ca(),z),oo={id:"app",ref:"app",class:"ghl-body"},to={class:"d-flex"},io={id:"form-builder",class:"hl_wrapper--inner form-builder"},ro={class:"loader-container"},so=["id"],no={key:0},uo={key:0},fo={key:1},co={key:2},vo={key:3},mo={key:4},po={class:"fields-container row"},yo={key:19,class:"field-divider"},go={key:0,style:{position:"absolute",right:"15px",transform:"translate(-50%, -50%)",top:"30px"}},ho={class:"ghl-button-bar"},bo={key:0,class:"ghl-btn-align ghl-btn-submit"},_o={key:0,id:"nextButton",type:"submit",class:"ghl-button ghl-next-button",name:"nextButton","aria-label":"Next",value:"Submit"},Fo={style:{position:"absolute",right:"15px",transform:"translate(-50%, -50%)",top:"30px"}},ko={key:1,class:"ghl-btn-align ghl-next-prev"},So=["disabled"],Vo=Fl(()=>x("span",{class:"right-pointing-triangle"},null,-1)),Do=[Vo],xo={key:2,class:"ghl-btn-align ghl-next-prev"},Io=["disabled"],Co=Fl(()=>x("span",{class:"left-pointing-triangle"},null,-1)),wo=[Co],Po={key:1,class:"ghl-progress-bar",role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0"},Lo={class:"ghl-progress-bar-text"},Oo={key:1,class:"ghl-footer-wrap"},Ao=["innerHTML"],Eo=ia({__name:"surveyComponent",props:{surveyData:{type:Object,required:!0},id:{type:String,required:!0},redirect:{type:Boolean,default:!0},source:{type:String,default:""},funnelPreview:{type:Boolean,default:!1},surveyElementClass:{type:String,required:!1},pageUrl:{type:String,default:void 0},baseReferrrer:{type:String,default:void 0},urlParams:{type:Object,default:void 0},stickyContactData:{type:Object,default:void 0},stickyContactFingerprint:{type:String,default:void 0}},emits:["on-submit"],setup(z,{emit:kl}){const p=z,{getSurveyStyle:Sl,setFormStyle:Vl,getFormWidth:Pe}=ya(),M=c([0]),Ke=c(!0),Le=lo(),Dl=ra(),xl={},Il={},Cl={},wl={},Oe=c(!0),Pl={},S=c([]),T=c([]),Ll={},Ol={},Ge=c(""),Ae=c(""),P=c(!0),Al={},Xe=c(!1),El={},W=c(!1),pe=c({}),K=c(""),Ze=c(!1),Ee=c(),R=c(""),G=c(!1),ye=c("US"),ge=c(),ne=c(""),X=c(""),he=c(""),q=c(0),Z=c(!1),ee=c(!0),g=c([]),le=c(0),ae=c(!1),el=c("slide_question"),ue=c(1),B=c(!0),oe=c(!1),Q=c([]),de=c(!1),ll=c(""),qe=c(""),Ne=c(!1),ql=c([]),al=c(!1),Nl={},ol=c(0),fe=c([]),tl=c(!1),U=c("");c("");const N=c(),be=c(!1),Tl=c(),$l={};let Bl={};const ce=c([]),C=c([]),te=c(),_e=c(),il=c(),Fe=c(),$=c(),L=c(!1),ve=c(),e=sa({phoneCountryIncluded:Il,phoneCountryCode:Cl,formattedPhone:xl,isPhoneValidObj:wl,formSurvey:Pl,formStyle:Ll,fieldStyle:Bl,buttonStyle:Ol,company:Al,formFieldsValue:El,multiStoreSkipLogic:Nl,validationError:$l}),Y=na(),rl=c(),sl=l=>{ge.value=l},Ml=l=>{Ze.value=l},Te=l=>{const{tag:t,value:o}=l;e.formFieldsValue[t]=o},Rl=l=>{N.value=l},Ul=l=>{Ee.value=l},jl=()=>{K.value&&te.value&&window.parent.postMessage(["highlevel.setHeight",{height:te.value.clientHeight,id:K.value}],"*")},me=l=>{const t=e.phoneCountryIncluded[l.tag],o=e.phoneCountryCode[l.tag];e.formFieldsValue[l.tag]=t;try{const s=window.libphonenumber.parsePhoneNumberFromString(t,o);e.isPhoneValidObj[l.tag]=!!s.isValid(),e.phoneCountryIncluded[l.tag]=s.isValid()?s.number:t,e.phoneCountryCode[l.tag]=s.country?s.country:o,e.formattedPhone[l.tag]=s.isValid()?s.formatNational():t}catch{e.isPhoneValidObj[l.tag]=!1,e.phoneCountryIncluded[l.tag]=t,e.phoneCountryCode[l.tag]=o,e.formattedPhone[l.tag]=t}l.tag==="phone"&&(ne.value=e.formFieldsValue[l.tag],e.formFieldsValue[l.tag]===void 0&&(e.formFieldsValue[l.tag]=null))},nl=()=>{S.value.forEach((l,t)=>{l.slideData.filter((o,s)=>{if(o.type==="textbox_list"){const i={};o.picklistOptions.forEach(function(r){i[r.id]=r.prefillValue}),e.formFieldsValue[o.tag]=i}else o.type==="source"&&(e.formFieldsValue[o.tag]=o.value||"")})})},ul=(l,t,o)=>{const s=l.scrollTop,i=t-s;let r=0;const n=20,h=function(u,v,_,d){return u/=d/2,u<1?_/2*u*u+v:(u--,-_/2*(u*(u-2)-1)+v)},b=function(){r+=n;const u=h(r,s,i,o);l.scrollTop=u,r<o&&setTimeout(b,n)};b()},Hl=()=>{var l,t,o,s,i,r,n,h,b,u,v;if(p.surveyData){const{country:_,formData:d,locationId:D}=Object.assign({},p.surveyData);if(ye.value=_,K.value=p.id,e.formSurvey=p.surveyData,d.form===void 0)return!1;de.value="stickyContact"in d.form?d.form.stickyContact:!1,he.value=d.form.fbPixelId,R.value=D;const F=p.surveyElementClass?`.${p.surveyElementClass}${bl}`:bl;if("style"in d.form){const f=d.form.style;Vl(f,d.form.width),ve.value=d==null?void 0:d.fieldCSS,ve.value&&p.surveyElementClass&&(Ja()||(ve.value=(l=ve.value)==null?void 0:l.replaceAll("#_builder-form",`.${p.surveyElementClass} #_builder-form`))),Xe.value=f.ac_branding,"bgImage"in f&&f.bgImage!==""&&(ll.value=`${p.funnelPreview?`.${p.surveyElementClass} #form-builder`:"body"} {background-image: url('${f.bgImage}');background-size: cover;}`)}if("fieldStyle"in d.form){const f=d.form.fieldStyle;e.fieldStyle={bgColor:f.bgColor,labelColor:f.labelColor,placeholderColor:f.placeholderColor,border:f.border,width:f.width,padding:f.padding,shadow:f.shadow}}if("button"in d.form){const f=d.form.button;e.buttonStyle={bgColor:f==null?void 0:f.background,color:f==null?void 0:f.color,border:((t=f==null?void 0:f.border)==null?void 0:t.border)||0,borderColor:((o=f==null?void 0:f.border)==null?void 0:o.color)||ja,radius:(s=f==null?void 0:f.border)==null?void 0:s.radius,padding:(i=f==null?void 0:f.border)==null?void 0:i.padding}}if("customStyle"in d.form&&d.form.customStyle.length>0&&(Ge.value=d.form.customStyle.replace(".form-element","")),(n=(r=d==null?void 0:d.form)==null?void 0:r.style)!=null&&n.color&&(Ae.value=`${F}label{color:#${(b=(h=d==null?void 0:d.form)==null?void 0:h.style)==null?void 0:b.color};}`),(v=(u=d==null?void 0:d.form)==null?void 0:u.fieldStyle)!=null&&v.labelColor&&(Ae.value=`${F}label{color:#${d.form.fieldStyle.labelColor};}`),"company"in d.form&&(e.company=d.form.company),"formLabelVisible"in d.form&&(P.value=d.form.formLabelVisible),"formAction"in d.form&&(ae.value=d.form.formAction.fieldSettingEnable,"headerImageSrc"in d.form.formAction&&d.form.formAction.headerImageSrc.trim().length>0&&(qe.value=d.form.formAction.headerImageSrc),"headerFullWidthEnable"in d.form.formAction&&(Ne.value=d.form.formAction.headerFullWidthEnable)),"surveyLogicLinkById"in p.surveyData.formData&&(al.value=p.surveyData.formData.surveyLogicLinkById),"slides"in p.surveyData.formData){if(S.value=[],T.value=[],ae.value){const f=p.surveyData.formData.slides[0],O=[];f.slideData.length>0&&(O.push({active:f.active,button:f.button,logic:"logic"in f?f.logic:{},slideName:f.slideName,slideData:[]}),f.slideData.map(V=>{const y=O.length-1;if(O[y].slideData.find(A=>A.type!=="img"&&A.type!=="h1"&&A.type!=="html")===void 0)V.hidden?T.value.push(V):(T.value.push(V),O[y].slideData.push(V));else if(V.hidden)T.value.push(V);else{T.value.push(V),O.push({active:f.active,button:f.button,logic:"logic"in f?f.logic:{},slideName:f.slideName,slideData:[]});const A=O.length-1;O[A].slideData.push(V)}})),S.value=O,el.value="slide_question",ue.value=O.length}else{let f=[];f=p.surveyData.formData.slides;const O=[];f.forEach((V,y)=>{O.push({active:V.active,button:V.button,logic:"logic"in V?V.logic:{},slideName:V.slideName,id:V.id,slideData:[]}),V.slideData.forEach(function(w,A){w.hidden?T.value.push(w):(T.value.push(w),O[y].slideData.push(w))})}),S.value=O.filter(function(V){return V.slideData.length>0}),el.value="slide_question",ue.value=S.value.length}ue.value===1&&(ee.value=!1)}Oe.value=!1}},zl=l=>{const{item:t,index:o,checkVal:s,isChecked:i}=l,r=[];if(i)fe.value.push(o),Array.isArray(e.formFieldsValue[t.tag])?e.formFieldsValue[t.tag].push(s):(r.push(s),e.formFieldsValue[t.tag]=r);else{let n=e.formFieldsValue[t.tag].indexOf(s);e.formFieldsValue[t.tag].splice(n,1),n=fe.value.indexOf(o),fe.value.splice(n,1)}ol.value=Math.max(...fe.value),Se(t)},dl=async l=>{var F,f,O,V;if(G.value)return;for(let y in e.phoneCountryIncluded)e.phoneCountryIncluded[y]&&me({tag:y});if(await Ba(e.formFieldsValue)>50*1024*1024){alert("The total size of the attached files cannot be more that 50MB");return}if(g.value=[],l!==void 0&&l){let y=!0;if(y=fl(q.value),!y){const w=document.getElementById("hl_form_builder_main"+U.value);return w&&ul(w,w.offsetTop,500),!1}}Z.value=!1;const o=await gl(e.formFieldsValue,N.value);e.formFieldsValue=o.formFieldsValue;const s=await Ma(Y,T.value,e.formFieldsValue);if(e.formFieldsValue=s.formFieldsValue,G.value=!0,e.formFieldsValue.formId=K.value,e.formFieldsValue.location_id=R.value,ne.value&&(e.formFieldsValue.phone=ne.value),e.formFieldsValue.disqualified=Q.value.length>0,de.value){let y;if(p.stickyContactFingerprint&&(y=p.stickyContactFingerprint),!y&&typeof Storage<"u")try{y=localStorage.getItem(R.value)}catch{}y?e.formFieldsValue.contact_id=y:y=pa(R.value).value}const i=Y.query.contact_id||((F=p.urlParams)==null?void 0:F.contact_id);i&&(e.formFieldsValue.query_contact_id=i);const r=Ya(e.formSurvey.locationId);r&&(e.formFieldsValue.sessionId=r);const n=Ka();e.formFieldsValue.eventData={...Ga(p.pageUrl,p.baseReferrrer),fbEventId:n};const h=Xa(e.formSurvey.locationId);h&&(e.formFieldsValue.sessionFingerprint=h),Ee.value&&(e.formFieldsValue.captchaToken=Ee.value);var b=new FormData;let u={};if(Object.keys(e.formFieldsValue).forEach(async y=>{var w;if(e.formFieldsValue[y]instanceof File)b.append(y,e.formFieldsValue[y]);else if((w=e.formFieldsValue[y])!=null&&w.files){const A=Object.values(e.formFieldsValue[y].files);A.length&&await Promise.all(A.map(ie=>{b.append(y,ie)}))}else e.formFieldsValue[y]&&(u[y]=e.formFieldsValue[y])}),p.funnelPreview){let{domain:y,page_url:w}=Y.query;y||(y=window.location.hostname,w=window.location.pathname),u.funneEventData={event_type:"optin",domain_name:y,page_url:w,funnel_id:Le.value.funnelId,page_id:Le.value.funnelPageId,funnel_step_id:Le.value.stepId}}b.set("formData",JSON.stringify(u));const _={method:"POST",body:b},d=Dl.REST_API_URLS,D=await $fetch(d+"/surveys/submit",_);if(D.status){D.surveyData;const y="_ud";let w=D.sessionFingerprint;Za({sessionId:D.sessionId||null,locationId:e.formSurvey.locationId});const A=Ha(D.contact,!0);if(_l(y,JSON.stringify(A)),_l(R.value,D.fingerprint),window.parent.postMessage(["set-sticky-contacts",y,JSON.stringify(A),R.value,D.fingerprint],"*"),w&&await eo(R.value,w),kl("on-submit",{fingerprint:D.fingerprint}),J(()=>{Wa("track",p.surveyData.formData.form.formSubmissionEvent,n)}),p.redirect===!1)return;if(e.formFieldsValue.disqualified)if(W.value=!0,e.formSurvey.formData.form.formAction.endsurveyType==="1"){const ta=Qe(e.formSurvey.formData.form.formAction.endsurveyUrl,A);Ce(ta)}else X.value=e.formSurvey.formData.form.formAction.endsurveyText!==""?Je(e.formSurvey.formData.form.formAction.endsurveyText,A):"Survey Ended! Please try again",pe.value={action:"submit-form",message:X};else if("formAction"in e.formSurvey.formData.form&&e.formSurvey.formData.form.formAction.actionType==="1"){const ie=Qe(e.formSurvey.formData.form.formAction.redirect_url,A);Ce(ie)}else if("redirect_url"in e.formSurvey.formData.form&&e.formSurvey.formData.form.redirect_url!==""){const ie=Qe(e.formSurvey.formData.form.redirect_url,A);Ce(ie)}else W.value=!0,X.value=e.formSurvey.formData.form.formAction.thankyouText?Je(e.formSurvey.formData.form.formAction.thankyouText,A):"Thanks for submiting details, Will get back to you soon!";pe.value={action:"submit-form",message:X,style:(V=(O=(f=p==null?void 0:p.surveyData)==null?void 0:f.formData)==null?void 0:O.form)==null?void 0:V.submitMessageStyle},Z.value=!1,l&&$e(!0)}else G.value=!1;J(()=>{Re.value&&_e.value.scrollIntoView()})},$e=l=>{l?le.value=100:le.value=Math.round(q.value*100/ue.value)},Wl=l=>{var t=Ua;return!!t.test(l)},fl=l=>{var i,r,n,h,b;const t=gl(e.formFieldsValue,N.value);e.formFieldsValue=t.formFieldsValue;const o=S.value[l].slideData;for(const u of o){const v="id"in u?u.id:u.tag,_=u.type;if(v==="country"&&u.required&&!e.formFieldsValue[v]&&g.value.push({field:`The ${u.label} field is required`,type:"email"}),v==="website"&&e.formFieldsValue[v]&&(Wl(e.formFieldsValue[v])||g.value.push({field:`The ${u.label} field is not a valid URL`,type:"website"})),_==="text"||_==="number"||_==="email"||_==="textarea"||_==="large_text"||_==="monetory"||_==="single_options"||_==="date"||_==="website"){let d="question",D="";if(u.tag==="phone"&&ne.value)if(Ke&&(e.isPhoneValidObj[v]===void 0||e.isPhoneValidObj[v]===!0))e.formFieldsValue.phone=ne.value;else{const F={field:"Invalid phone number",type:"phone"};g.value.push(F)}if(_==="date"&&e.formFieldsValue[u.tag]){var s=we(e.formFieldsValue[u.tag]).format("YYYY-MM-DD");we(s).isValid()?u.tag==="date_of_birth"&&we(s).isAfter(we())&&g.value.push({field:u.label,type:"future_date"}):g.value.push({field:u.label,type:"invalid_date"})}if(_==="monetory"){let F=(i=e.formFieldsValue[u.tag])==null?void 0:i.replaceAll(",","");F&&isNaN(F)?g.value.push({field:"Invalid Monetory Format",type:"monetory"}):u.required&&!e.formFieldsValue[u.tag]?g.value.push({field:"Monetory Field required!",type:"monetory"}):!isNaN(F)&&F!==""&&(e.formFieldsValue[u.tag]=parseFloat(F).toFixed(2).toString())}if(u.tag==="email"&&((n=(r=e.formFieldsValue[v])==null?void 0:r.trim())==null?void 0:n.length)>0&&(Ra.test(e.formFieldsValue[v])||g.value.push({field:"Invalid Email Address",type:"email"})),e.formFieldsValue[v]===""&&(e.formFieldsValue[v]=null),(!(v in e.formFieldsValue)||e.formFieldsValue[v]===null||e.formFieldsValue[v]===void 0||e.formFieldsValue[v]&&((h=e.formFieldsValue[v])==null?void 0:h.trim().length)<=0)&&u.required===!0){const F={field:D.length>0?D:u.label,type:d};g.value.push(F)}}else if(u.type==="textbox_list"&&u.required===!0){let d={},D=0;const F=e.formFieldsValue[v];for(const f in F)F[f]===""?d={field:u.label,type:"question"}:D++;D<=0&&g.value.push(d)}else if(_==="checkbox"||_==="multiple_options"||_==="radio"){if((!(v in e.formFieldsValue)||e.formFieldsValue[v]===null||e.formFieldsValue[v].length<=0)&&u.required===!0){const d={field:u.label,type:"question"};g.value.push(d)}}else if(_==="captcha"){if(!Ze.value){const d={field:"Invalid captcha",type:"captcha"};g.value.push(d)}}else if(_==="phone"){if((!(v in e.formFieldsValue)||e.formFieldsValue[v]===null||((b=e.formFieldsValue[v])==null?void 0:b.trim().length)<=0)&&u.required===!0){const d={field:u.label,type:"question"};g.value.push(d)}if((!Ke||e.isPhoneValidObj[v]===!1)&&e.formFieldsValue[v]){const d={field:"Invalid phone number",type:"phone"};g.value.push(d)}}else if(_==="cascade_dropdown"){let d={},D=0;e.formFieldsValue[v]===void 0&&u.required===!0?(d={field:u.label,type:"question"},g.value.push(d)):e.formFieldsValue[v]!==void 0&&u.required===!0&&(e.formFieldsValue[v].forEach(function(f,O){for(const V in f)f[V]===""&&(d={field:u.label,type:"question"},D++)}),D>0&&g.value.push(d))}else if(_==="file_upload"){if(u.required&&!e.formFieldsValue[v])g.value.push({field:`${u.fieldName} is required`,type:"file_upload"});else if(e.formFieldsValue[v]){let d=e.formFieldsValue[v].files.length;const D=u.picklistOptions;for(let F=0;F<d;F++){const f="."+e.formFieldsValue[v].files[F].name.split(".").pop();if(D.length>0&&D.indexOf(f)===-1){g.value.push({field:`${u.fieldName} - File format is not supported`,type:"file_upload"});break}}}}else _==="signature"?u.required&&!e.formFieldsValue[v]&&g.value.push({field:`${u.fieldName} is required`,type:"file_upload"}):_==="numerical"&&(u.required&&!e.formFieldsValue[v]?g.value.push({field:`${u.fieldName} is required`,type:"numerical"}):e.formFieldsValue[v]&&isNaN(e.formFieldsValue[v])&&g.value.push({field:`${u.fieldName} is not a valid number`,type:"numerical"}))}return g.value.length>0?(J(()=>il.value.scrollIntoView({behavior:"smooth"})),!1):!0},Be=l=>{var t,o,s,i;if(l.index<0&&l.index===-1)if(e.formSurvey.formData.form.formAction.disqualifiedType==="1"){g.value=[],W.value=!0,B.value=!1;const n=(i=(s=(o=(t=e==null?void 0:e.formSurvey)==null?void 0:t.formData)==null?void 0:o.form)==null?void 0:s.formAction)==null?void 0:i.disqualifiedUrl;Ce(n)}else return g.value=[],W.value=!0,B.value=!1,X.value=e.formSurvey.formData.form.formAction.disqualifiedText!==""?Je(e.formSurvey.formData.form.formAction.disqualifiedText,e.formFieldsValue):"Survey Disqualified! Please try again",pe.value={action:"submit-form",message:X},le.value=100,l;else return l.index<0&&l.index===-2&&(g.value=[],oe.value=!0,delete l.index),l},Me=l=>{vl()},j=l=>{let t={};const o=["header","image","html"];if(ae.value)Me();else if(t=S.value[q.value],"slideData"in t&&t.slideData.length>1){const s=t.slideData[t.slideData.length-1];(e.formFieldsValue[s.tag]!==void 0||o.indexOf(s.tag)>=0)&&Me()}else Me()},Ql=l=>{oe.value=!1;let t={},o={source:"logic"};if(e.multiStoreSkipLogic={},t=S.value[q.value],t!==void 0&&"logic"in t&&Object.keys(t.logic).length>0&&(l.type==="single_options"||l.type==="checkbox"||l.type==="radio")&&(l.id in t.logic||l.tag in t.logic)){const s=e.formFieldsValue[l.tag],i=t.logic[l.tag];for(const r in i)!Array.isArray(s)&&i[r].optionName===s?o={source:"logic",index:i[r].index}:Array.isArray(s)&&s.indexOf(i[r].optionName)>=0&&l.picklistOptions[ol.value]===i[r].optionName&&(o={source:"logic",index:i[r].index})}if("index"in o)o=Be(o),oe.value&&Q.value.indexOf(l.id)<0&&Q.value.push(l.id);else{const s=Q.value.indexOf(l.id);s>-1&&Q.value.splice(s,1)}B.value&&l.type!=="checkbox"&&!Ue.value?j():B.value&&l.type==="checkbox"&&(e.multiStoreSkipLogic=o)},Jl=l=>{oe.value=!1;let t="",o={},s={source:"logic"};if(e.multiStoreSkipLogic={},o=S.value[q.value],o!==void 0&&"logic"in o&&Object.keys(o.logic).length>0&&(l.type==="single_options"||l.type==="checkbox"||l.type==="radio")){const i=[];o.slideData.forEach(n=>{i.push({id:n.tag,value:l.type==="single_options"?l.selectedOption:e.formFieldsValue[n.tag]})});const r=o.logic;i.forEach(n=>{for(const h in r)if(n&&n.id===h)for(const b in r[h])!Array.isArray(n.value)&&r[h][b].optionName===n.value?(t=ke(r[h][b].id),s={source:"logic",index:t}):Array.isArray(n.value)&&n.value.indexOf(r[h][b].optionName)>=0&&(t=ke(r[h][b].id),s={source:"logic",index:t})})}if("index"in s)s=Be(s),oe.value&&Q.value.indexOf(l.id)<0&&Q.value.push(l.id);else{const i=Q.value.indexOf(l.id);if(i>-1)Q.value.splice(i,1);else{const r=p.surveyData.formData.slides[q.value];let n=r&&r.jumpTo,{slides:h}=p.surveyData.formData,b=null;n&&(h.forEach((u,v)=>{u.id===n&&(b=v)}),b!==null&&(s={source:"logic",index:b}))}}B.value&&l.type!=="checkbox"&&!Ue.value?j():B.value&&l.type==="checkbox"&&(e.multiStoreSkipLogic=s)},ke=l=>{let t;return ae.value?t=S.value.findIndex(o=>{if(o.slideData.filter(i=>i.id===l||i.tag===l).length>0)return!0}):t=S.value.findIndex(o=>o.id===l),t===-1&&(t=q.value+1),l==="endsurvey"?t=-2:l==="disqualify"&&(t=-1),t},Se=l=>{l.type==="single_options"&&(e.formFieldsValue={...e.formFieldsValue,[l.tag]:l.selectedOption}),al.value?Jl(l):Ql(l)},Yl=l=>{const{item:t,event:o}=l;e.formFieldsValue[t.tag]=o.target.value},cl=()=>{be.value=!0,setTimeout(()=>{be.value=!1},1e3)},vl=()=>{De.value||cl();let l={source:"logic"},t="";const o=S.value[q.value];if(o!==void 0&&"logic"in o&&Object.keys(o.logic).length>0){let s=[];const i=o.slideData.filter(r=>r.type!=="img"&&r.type!=="h1"&&r.type!=="html");ae.value?s.push(i[0]):s=i,s.forEach(function(r,n){if(r.id in o.logic&&r.id in e.formFieldsValue&&(r.type==="single_options"||r.type==="checkbox"||r.type==="radio")){const h=o.logic[r.id],b=e.formFieldsValue[r.id];for(const u in h)if(!Array.isArray(b)&&h[u].optionName===b)t=ke(h[u].id),l={source:"logic",index:t};else if(Array.isArray(b)&&b.indexOf(h[u].optionName)>=0){t=ke(h[u].id);const v=e.formFieldsValue[r.tag].map(function(_){return r.picklistOptions.indexOf(_)});r.picklistOptions[Math.max(...v)]===h[u].optionName&&(l={source:"logic",index:t})}}})}if(l&&l.index===-1)return Be(l);if(l&&l.index===-2&&(g.value=[],oe.value=!0,delete l.index),l.hasOwnProperty("index"))Ve(l);else{const s=p.surveyData.formData.slides[q.value];let i=s&&s.jumpTo,{slides:r}=p.surveyData.formData;if(i){let n=null;r.forEach((h,b)=>{h.id===i&&(n=b)}),Ve(n!==null?{source:"logic",index:n}:l)}else Ve(l)}},Ve=l=>{if(me({tag:"phone"}),g.value=[],fe.value=[],!ee.value)return dl(!0),!1;Object.keys(e.multiStoreSkipLogic).length>1&&(l={source:e.multiStoreSkipLogic.source,index:e.multiStoreSkipLogic.index},e.multiStoreSkipLogic={});const t=parseInt(q.value),o=Object.keys(l).length>0&&"index"in l?l.index:t+1;let s=!0;if(s=fl(t),!s){const h=document.getElementById("hl_form_builder_main"+U.value);return h&&ul(h,h.offsetTop,500),!1}const i=ce.value[t];i.classList.add("ghl-page-rotateSlideOutNext");const r=ce.value[o];r.classList.add("ghl-page-current"),r.classList.add("ghl-page-rotateSlideInNext"),Fe.value.classList.add("setOverflow"),De.value?(i.classList.remove("ghl-page-rotateSlideOutNext"),i.classList.remove("ghl-page-current"),r.classList.remove("ghl-page-rotateSlideInNext"),Fe.value.classList.remove("setOverflow")):setTimeout(()=>{i.classList.remove("ghl-page-rotateSlideOutNext"),i.classList.remove("ghl-page-current"),r.classList.remove("ghl-page-rotateSlideInNext"),Fe.value.classList.remove("setOverflow")},1e3),M[M.value.length-1]!=o&&M.value.push(o),q.value=o,(q.value>=1||pl.value&&M.value.length>2)&&(Z.value=!0),q.value===ue.value-1&&(ee.value=!1),$e(),J(()=>{Re.value&&_e.value.scrollIntoView()})},Kl=()=>{me({tag:"phone"}),De.value||cl(),g.value=[];const l=M.value[M.value.length-1];if(M.value.length<2){Z.value=!1;return}const t=ce.value[l];t.classList.add("ghl-page-rotateSlideOutPrev");const o=M.value[M.value.length-2],s=ce.value[o];s.classList.add("ghl-page-current"),s.classList.add("ghl-page-rotateSlideInPrev"),Gl(o),De.value?(t.classList.remove("ghl-page-rotateSlideOutPrev"),t.classList.remove("ghl-page-current"),s.classList.remove("ghl-page-rotateSlideInPrev")):setTimeout(()=>{t.classList.remove("ghl-page-rotateSlideOutPrev"),t.classList.remove("ghl-page-current"),s.classList.remove("ghl-page-rotateSlideInPrev")},1e3),M.value.pop(),q.value=o,q.value<=0&&(Z.value=!1),q.value!==S.value.length-1&&(ee.value=!0),$e(),J(()=>{Re.value&&_e.value.scrollIntoView()})},Gl=l=>{S.value[l]},Xl=l=>{e.formFieldsValue[l.tag]=""},Zl=l=>{const{date:t,item:o}=l;e.formFieldsValue[o.tag]=t,!Ue.value&&t&&j()};je(S,()=>{nl()}),je(()=>p.urlParams,()=>{p.urlParams&&yl(p.urlParams,Y,e.phoneCountryIncluded,N.value,e.formFieldsValue,T.value).then(l=>{e.phoneCountryIncluded=l.phoneCountryIncluded,e.formFieldsValue=l.formFieldsValue,N.value=l.formattedCountry})}),je(()=>p.stickyContactData,()=>{if(p.stickyContactData&&de.value){if($.value=S.value.map(l=>l.slideData.map(t=>t.tag)).reduce((l,t)=>[...new Set([...l,...t])],[]),!$.value.length)return;We(p.stickyContactData,R.value,$.value,e.formFieldsValue,e.phoneCountryIncluded,N.value).then(l=>{e.formFieldsValue=l.formFieldsValue,e.phoneCountryIncluded=l.phoneCountryIncluded,N.value=l.formattedCountry}).catch(l=>{console.error("Failed at fillDataFromCookie",l)})}});const ea=H(()=>(console.log("Loc",hl.find(l=>l.code===ye.value)),hl.find(l=>l.code===ye.value)||{})),ml=H(()=>ge.value||ye.value),De=H(()=>{var l,t,o;return(o=(t=(l=e.formSurvey)==null?void 0:l.formData)==null?void 0:t.form)==null?void 0:o.isAnimationDisabled}),Re=H(()=>{var l,t,o;return(o=(t=(l=e.formSurvey)==null?void 0:l.formData)==null?void 0:t.form)==null?void 0:o.isSurveyScrollEnabled}),la=H(()=>Object.values(Qa)),pl=H(()=>{var l,t,o;return((o=(t=(l=e.formSurvey)==null?void 0:l.formData)==null?void 0:t.form)==null?void 0:o.isBackButtonEnable)&&Z.value}),Ue=H(()=>{var l,t,o;return(o=(t=(l=e.formSurvey)==null?void 0:l.formData)==null?void 0:t.form)==null?void 0:o.disableAutoNavigation}),aa=H(()=>{var l,t,o,s,i,r;return!(((o=(t=(l=e.formSurvey)==null?void 0:l.formData)==null?void 0:t.form)==null?void 0:o.hasOwnProperty("isProgressBarEnabled"))&&((r=(i=(s=e.formSurvey)==null?void 0:s.formData)==null?void 0:i.form)==null?void 0:r.isProgressBarEnabled)===!1)});H(()=>{for(const l in C.value)l.resizeCanvas&&J(()=>{l.resizeCanvas.resizeCanvas()});te.value&&K.value&&window.parent.postMessage(["highlevel.setHeight",{height:te.value.clientHeight,id:K.value}],"*")});const oa=H(()=>p.surveyData!=null&&Xe.value&&!Oe.value&&!W.value);return Hl(),ua(()=>{if(yl(p.urlParams,Y,e.phoneCountryIncluded,N.value,e.formFieldsValue,T.value).then(l=>{e.phoneCountryIncluded=l.phoneCountryIncluded,e.formFieldsValue=l.formFieldsValue,N.value=l.formattedCountry}),nl(),!p.funnelPreview&&he.value!==void 0&&he.value!==""&&J(()=>{za(he.value,p.surveyData.formData.form.pageViewEvent)}),de.value){if(!$.value){const l=T.value.filter(t=>t.type!=="img"&&t.type!=="h1"&&t.type!=="html").map(t=>t.tag);$.value=[...new Set(l,S.value.map(t=>t.slideData.map(o=>o.tag)))]}if(!$.value.length)return;We(void 0,R.value,$.value,e.formFieldsValue,e.phoneCountryIncluded,N.value).then(l=>{e.formFieldsValue=l.formFieldsValue,e.phoneCountryIncluded=l.phoneCountryIncluded,N.value=l.formattedCountry}).catch(l=>{console.error("Failed at fillDataFromCookie",l)})}if(S.value.length&&S.value.forEach((l,t)=>{l.slideData.forEach((o,s)=>{if(o.type==="html"&&o&&"html"in o){const i=o.html.replace(/[‘’]/g,"'").replace(/[“”]/g,'"');ql.value.push({scriptString:i,index:t,indexChild:s})}})}),J(()=>{window.top!==window.self&&te.value.classList.add("in-iframe"),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/Android/i))&&(tl.value=!0)}),U.value=Math.random().toString(36).slice(2),Y.query.hasOwnProperty("sticky_contact_help")&&Y.query.sticky_contact_help==="true"&&(console.log("%c Sticky Contact data","color: black; font-weight: bold; background-color: white"),console.log("%c ===================","color: black; font-weight: bold; background-color: white"),console.log(JSON.parse(localStorage.getItem("_ud"))),console.log("%c ===================","color: black; font-weight: bold; background-color: white")),p.stickyContactData&&de.value){if(!$.value&&!$.value){const l=T.value.filter(t=>t.type!=="img"&&t.type!=="h1"&&t.type!=="html").map(t=>t.tag);$.value=[...new Set(l,S.value.map(t=>t.slideData.map(o=>o.tag)))]}if(!$.value.length)return;We(p.stickyContactData,R.value,$.value,e.formFieldsValue,e.phoneCountryIncluded,N.value).then(l=>{e.formFieldsValue=l.formFieldsValue,e.phoneCountryIncluded=l.phoneCountryIncluded,N.value=l.formattedCountry}).catch(l=>{console.error("Failed at fillDataFromCookie",l)})}L.value=!0}),rl.value=ga(S.value),ma({__dangerouslyDisableSanitizers:["style"],style:[{children:ll.value,type:"text/css"},{children:Ae.value,type:"text/css"},{children:ve.value,type:"text/css"},{children:Ge.value,type:"text/css"}],link:[...rl.value]}),(l,t)=>(m(),k("div",{ref:o=>{te.value=o},class:"hl-app"},[x("div",oo,[x("section",to,[x("section",io,[x("div",ro,[xe(Ye,{loading:a(Oe),color:"#188bf6",size:"30px"},null,8,["loading"])]),x("section",{ref:o=>{_e.value=o},id:"hl_form_builder_main"+a(U),class:"hl_form-builder--main"},[a(qe).trim().length>0?(m(),k("div",no,[x("div",{class:re([()=>{a(Ne)},"ghl-banner"]),style:Ie({maxWidth:a(Ne)?"100%":a(Pe)+"px"})},[xe(ao,{url:a(qe),onLoad:jl,alt:"banner"},null,8,["url"])],6)])):E("",!0),x("div",{style:Ie({maxWidth:a(Pe)+"px"}),class:"ghl-form-wrap",ref:o=>{Fe.value=o}},[a(W)?E("",!0):(m(),k("form",{key:0,id:"_builder-form",style:Ie(a(Sl)()),onSubmit:t[1]||(t[1]=da(o=>dl(!0),["prevent"])),name:"builder-form",class:"ghl-survey-form"},[a(g).length?(m(),k("div",{key:0,ref:o=>{il.value=o},class:"alert alert-danger",role:"alert"},[x("ul",null,[(m(!0),k(He,null,ze(a(g),(o,s)=>(m(),k("li",{key:s},[x("div",null,[o.type=="question"?(m(),k("span",uo,'Question, "'+se(o.field)+'" is required.',1)):o.type=="phone"||o.type=="email"||o.type=="file_upload"||o.type=="numerical"||o.type=="captcha"||o.type=="website"?(m(),k("span",fo,se(o.field),1)):o.type=="future_date"?(m(),k("span",co,se(o.field)+" cannot be in the future ",1)):o.type=="invalid_date"?(m(),k("span",vo,se(o.field)+" should have a valid date. ",1)):o.type=="monetory"?(m(),k("span",mo,se(o.field),1)):E("",!0)])]))),128))])],512)):E("",!0),!a(W)&&a(B)?(m(),k("div",{key:1,class:re([()=>a(tl)||a(Pe)<=600?"ghl-ques-wrap-less":"ghl-ques-wrap-big","ghl-question-set"])},[(m(!0),k(He,null,ze(a(S),(o,s)=>(m(),k("div",{key:s,ref_for:!0,ref:i=>{a(ce)[s]=i},class:re([{"ghl-page-current":s==0},"form-builder--wrap-questions ghl-question"])},[x("div",po,[(m(!0),k(He,null,ze(o.slideData,(i,r)=>(m(),k("div",{key:r,class:"menu-field-wrap col-12"},[x("div",{class:re([r%2==0?"f-even":"f-odd","form-field-container"])},[i.type==="text"&&a(L)?(m(),I(ha,{key:0,kind:"survey",item:i,"form-label-visible":a(P),"phone-country-included":a(e).phoneCountryIncluded,"phone-country-code":a(e).phoneCountryCode,"formatted-phone":a(e).formattedPhone,"location-country":a(ml),"form-fields-value":a(e).formFieldsValue,"phone-country-derived":a(ge),onUpdatePhoneCountryDerived:sl,onCustomFieldPhoneNumberUpdate:me,onIsSlideMovable:j,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","formatted-phone","location-country","form-fields-value","phone-country-derived","onUpdatePhoneCountryDerived","onCustomFieldPhoneNumberUpdate"])):E("",!0),i.type==="phone"&&a(L)?(m(),I(ba,{key:1,kind:"survey",item:i,"form-label-visible":a(P),"phone-country-included":a(e).phoneCountryIncluded,"phone-country-code":a(e).phoneCountryCode,"location-country":a(ml),"formatted-phone":a(e).formattedPhone,"phone-country-derived":a(ge),onUpdatePhoneCountryDerived:sl,onCustomFieldPhoneNumberUpdate:me,onIsSlideMovable:j,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","formatted-phone","phone-country-derived","onUpdatePhoneCountryDerived","onCustomFieldPhoneNumberUpdate"])):(i.type==="number"||i.type==="numerical")&&a(L)?(m(),I(_a,{key:2,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,onIsSlideMovable:j,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value"])):i.type==="email"&&a(L)?(m(),I(Fa,{key:3,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,onIsSlideMovable:j,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value"])):i.type==="h1"?(m(),I(ka,{key:4,item:i,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item"])):i.type==="textbox_list"&&a(L)?(m(),I(Sa,{key:5,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(U),ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id"])):(i.type==="textarea"||i.type=="large_text")&&a(L)?(m(),I(Va,{key:6,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value"])):i.type==="img"&&"url"in i?(m(),I(Da,{key:7,kind:"survey",item:i,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item"])):i.type==="html"?(m(),I(xa,{key:8,item:i,localTagId:a(U)+s+r,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","localTagId"])):i.type==="captcha"&&a(L)?(m(),I(Ia,{key:9,kind:"survey",item:i,"form-label-visible":a(P),"captcha-input-value":a(Tl),"survey-field-validate":a(g),"local-tag-id":a(U),"validation-error":a(e).validationError,onUpdateIsCaptchaVerified:Ml,onUpdateCaptchaToken:Ul,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","captcha-input-value","survey-field-validate","local-tag-id","validation-error"])):i.type==="monetory"&&a(L)?(m(),I(Ca,{key:10,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,"locale-currency":a(ea),onUpdateFormFieldsValue:Te,onIsSlideMovable:j,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value","locale-currency"])):i.type==="checkbox"&&a(L)?(m(),I(wa,{key:11,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(U),onHandleCheckBox:zl,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id"])):i.type==="radio"&&i.picklistOptions&&a(L)?(m(),I(Pa,{key:12,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(U),onIsSlideMovable:j,onHandleFieldLogicChange:Se,onResetFieldsValue:Xl,onSetRadioValue:Yl,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id"])):i.type==="radio"&&i.picklistOptionsImage&&a(L)?(m(),I(La,{key:13,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(U),onIsSlideMovable:j,onHandleFieldLogicChange:Se,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id"])):i.type==="select"&&i.tag=="country"&&a(L)?(m(),I(Oa,{key:14,kind:"survey",item:i,"form-label-visible":a(P),"formatted-country":a(N),countries:a(la),onUpdateFormattedCountry:Rl,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","formatted-country","countries"])):(i.type==="single_options"||i.type==="multiple_options")&&a(L)?(m(),I(Aa,{key:15,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,onHandleFieldLogicChange:Se,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value"])):i.type==="date"&&a(L)?(m(),I(Ea,{key:16,kind:"survey",item:i,"form-label-visible":a(P),"form-fields-value":a(e).formFieldsValue,onDateSelected:Zl,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-label-visible","form-fields-value"])):i.type==="file_upload"&&a(L)?(m(),I(qa,{key:17,kind:"survey",item:i,"form-fields-value":a(e).formFieldsValue,"form-label-visible":a(P),onUpdateFormFieldsValue:Te,ref_for:!0,ref:n=>{a(C)[r]=n}},null,8,["item","form-fields-value","form-label-visible"])):i.type==="signature"&&a(L)?(m(),I(Na,{key:18,kind:"survey",item:i,"form-fields-value":a(e).formFieldsValue,"form-label-visible":a(P),ref_for:!0,ref:n=>{a(C)[r]=n},onUpdateFormFieldsValue:Te},null,8,["item","form-fields-value","form-label-visible"])):E("",!0),!a(ae)&&a(S)[s].slideData.length>1&&i.type!=="html"&&i.type!=="img"&&i.type!=="h1"&&i.type!=="source"?(m(),k("div",yo)):E("",!0)],2)]))),128))])],2))),128))],2)):E("",!0),a(oa)?(m(),I(Ta,{key:2,style:{padding:"30px 0px"},company:a(e).company},null,8,["company"])):E("",!0),x("div",{class:re([{"ghl-footer-preview":z.source==="preview"},"ghl-footer"])},[a(B)?E("",!0):(m(),k("div",go,[xe(Ye,{loading:a(G),color:"#FFFFFF",size:"22px"},null,8,["loading"])])),x("div",ho,[!a(ee)&&!a(W)&&a(B)?(m(),k("div",bo,[a(G)?E("",!0):(m(),k("input",_o)),x("div",Fo,[xe(Ye,{loading:a(G),color:"#FFFFFF",size:"22px"},null,8,["loading"])])])):E("",!0),a(ee)&&a(B)?(m(),k("div",ko,[x("button",{disabled:a(be),onClick:t[0]||(t[0]=o=>vl()),type:"button",role:"button",class:"ghl-button ghl-next-button ghl-mobile-next","aria-label":"next button",style:{display:"block"}},Do,8,So)])):E("",!0),a(pl)?(m(),k("div",xo,[x("button",{disabled:a(be),onClick:Kl,type:"button",role:"button",class:"ghl-button ghl-back-button ghl-mobile-back","aria-label":"back button",style:{display:"block"}},wo,8,Io)])):E("",!0)]),a(aa)?(m(),k("div",Po,[x("div",Lo,se(a(le))+"% ",1),x("div",{class:re([()=>{a(le)},"ghl-progress-bar-background"])},[x("div",{style:Ie({width:a(le)+"%"}),class:"ghl-progress-bar-inner"},null,4)],2)])):E("",!0)],2)],36)),a(W)||!a(B)?(m(),I($a,{key:1,id:"_builder-form",payload:a(pe)},null,8,["payload"])):E("",!0)],4),"footerHtml"in z.surveyData.formData.form.formAction&&z.surveyData.formData.form.formAction.footerHtml.trim().length>0?(m(),k("div",Oo,[x("div",{innerHTML:z.surveyData.formData.form.formAction.footerHtml},null,8,Ao)])):E("",!0)],8,so)])])],512)],512))}});const Xo=va(Eo,[["__scopeId","data-v-c76b41cf"]]);export{Xo as default};
